FROM eclipse-temurin:21
RUN mkdir -p /experiment /data
VOLUME "/data"
ENV CLONING_RANGE=${CLONING_RANGE}
ENV CONST_COMPETITION_RATE=${CONST_COMPETITION_RATE}
ENV CONST_CONSUMPTION_RATE=${CONST_CONSUMPTION_RATE}
ENV CONST_PRODUCTION_RATE=${CONST_PRODUCTION_RATE}
ENV CONST_TRANSFER_RATE=${CONST_TRANSFER_RATE}
ENV DEFAULT=${DEFAULT}
ENV MAX=${MAX}
ENV MAX_CHILDREN=${MAX_CHILDREN}
ENV MAX_RESOURCE=${MAX_RESOURCE}
ENV MAX_SUCCESS=${MAX_SUCCESS}
ENV MIN=${MIN}
ENV MIN_SPAN_WAIT=${MIN_SPAN_WAIT}
ENV RESOURCE_LOWER_BOUND=${RESOURCE_LOWER_BOUND}
ENV SENSOR_COMPETITION_RATE=${SENSOR_COMPETITION_RATE}
ENV SENSOR_PRODUCTION_RATE=${SENSOR_PRODUCTION_RATE}
ENV SENSOR_TRANSFER_RATE=${SENSOR_TRANSFER_RATE}
ENV VESSELS_ADAPTATION_RATE=${VESSELS_ADAPTATION_RATE}
WORKDIR /experiment
COPY effects effects
COPY gradle gradle
COPY src src
COPY docker docker
COPY *.kts ./
COPY *.properties ./
COPY gradlew* ./
RUN sed -i '/alias(libs.plugins.gitSemVer)/d' build.gradle.kts
RUN sed -i '/alias(libs.plugins.multiJvmTesting)/d' build.gradle.kts
RUN sed -i '/multiJvm {/,/}/d' build.gradle.kts
ARG CLONING_RANGE
ARG CONST_COMPETITION_RATE
ARG CONST_CONSUMPTION_RATE
ARG CONST_PRODUCTION_RATE
ARG CONST_TRANSFER_RATE
ARG DEFAULT
ARG MAX
ARG MAX_CHILDREN
ARG MAX_RESOURCE
ARG MAX_SUCCESS
ARG MIN
ARG MIN_SPAN_WAIT
ARG RESOURCE_LOWER_BOUND
ARG SENSOR_COMPETITION_RATE
ARG SENSOR_PRODUCTION_RATE
ARG SENSOR_TRANSFER_RATE
ARG VESSELS_ADAPTATION_RATE
CMD ./gradlew runClassicVMCBatch
